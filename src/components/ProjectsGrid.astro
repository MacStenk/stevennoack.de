---
/**
 * Projects Grid Component
 * @description Grid of project cards with Markdown content
 * Now reads from Content Collection!
 */
import { getCollection } from 'astro:content';
import ProjectCard from './ProjectCard.astro';

// Load all projects from Content Collection and sort by order
const allProjects = await getCollection('projects');
const projects = allProjects.sort((a, b) => a.data.order - b.data.order);
---

<section id="projects" class="section">
  <h2 class="section-title">projects</h2>
  <div class="projects-grid">
    {projects.map(async (project) => {
      const { Content } = await project.render();
      return (
        <ProjectCard 
          title={project.data.title}
          status={project.data.status}
          url={project.data.url}
          techTags={project.data.techTags}
        >
          <Content />
        </ProjectCard>
      );
    })}
  </div>
</section>

<style>
  .section {
    padding: 4rem 2rem;
    max-width: 1200px;
    margin: 0 auto;
  }

  .section-title {
    font-size: 2rem;
    color: var(--matrix-green);
    text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
    margin-bottom: 3rem;
    font-family: 'Courier New', monospace;
  }

  .projects-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
  }

  @media (max-width: 768px) {
    .section {
      padding: 3rem 1.5rem;
    }

    .section-title {
      font-size: 1.5rem;
    }

    .projects-grid {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }
  }
</style>
